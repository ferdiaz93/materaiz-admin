import{f as y,g as m,am as p,t as P,j as b,a as e,a5 as f,k as q,i as T,G as C,F as E,W as v,J as F,e as h}from"./index-b7d380d3.js";import{C as S,a as N}from"./CustomBreadcrumbs-a2ae44ce.js";import{c as x,d as D}from"./productRepository-6951dba9.js";import{o as L}from"./yup-f2b37846.js";import{u as j,T as A,C as s,a as k,b as Q}from"./styles-d2076309.js";import{T as _}from"./TemplateNumberField-2f0989b0.js";import{T as $}from"./TemplateSelectField-f4276b4b.js";import{T as g}from"./TemplateTextField-37be45ad.js";import{d as B}from"./categoryRepository-d9c3434c.js";const U=y().shape({name:m().required("El nombre es requerido"),description:m().required("La descripción es requerida"),original_price:p().required("El precio original es requerido").min(0,"Debe ser mayor o igual a 0").typeError("Debe ser un número"),discount_price:p().transform((o,n)=>n===""||n===null?null:o).nullable().optional().positive("Debe ser mayor a 0").max(P("original_price"),"No puede ser mayor al precio original"),image:m().required("La imagen es requerida").url("Debe ser una URL válida"),category_id:p().typeError("La categoría es requerida").positive("Debe seleccionar una categoría").required("La categoría es requerida").moreThan(0,"Debe seleccionar una categoría válida")}),z={name:"",description:"",original_price:0,discount_price:null,image:"",category_id:0};function G({values:o,categories:n,onSubmit:d}){const l={...o,image:o.image||"",original_price:Number(o.original_price)||0,discount_price:o.discount_price?Number(o.discount_price):null,category_id:o.category_id||0},a=j({resolver:L(U),defaultValues:z,values:l,mode:"onBlur"});return b(A,{hf:a,onSubmit:d,children:[e(s,{name:"name",render:r=>e(g,{...r,label:"Nombre"})}),e(s,{name:"description",render:r=>e(g,{...r,label:"Descripción"})}),e(s,{name:"original_price",control:a.control,render:({field:r,fieldState:i,formState:t})=>e(_,{field:r,fieldState:i,formState:t,label:"Precio original"})}),e(s,{name:"discount_price",control:a.control,render:({field:r,fieldState:i,formState:t})=>e(_,{field:r,fieldState:i,formState:t,label:"Precio con descuento",value:r.value===null?"":r.value,onChange:c=>{const{value:u}=c.target;u===""||u===null?r.onChange(null):r.onChange(Number(u))}})}),e(s,{name:"image",control:a.control,render:({field:r,fieldState:i,formState:t})=>e(g,{field:r,fieldState:i,formState:t,label:"Imagen (URL)",placeholder:"https://ejemplo.com/imagen.jpg",required:!0})}),e(s,{name:"category_id",control:a.control,render:({field:r,fieldState:i,formState:t})=>e($,{field:r,fieldState:i,formState:t,label:"Categoría",placeholder:"Seleccionar categoría",options:n.map(c=>({value:c.id,label:c.name}))})}),e(k,{children:e(Q,{children:"Guardar"})})]})}const O=()=>{const o=f(),{enqueueSnackbar:n}=q(),d=T(),{themeStretch:l}=C(),a=x(Number(o.id)),r=B(),i=D(),t=async c=>{await i.mutateAsync({...c,id:Number(o.id)}),n({message:"Producto actualizado!"}),d(h.dashboard.products.list)};return b(E,{children:[e(v,{children:e("title",{children:" Panel Administrativo | Editar Producto "})}),b(F,{maxWidth:l?!1:"lg",children:[e(S,{heading:"Editar - Producto",links:[{name:"Listado",href:h.dashboard.products.list},{name:"Editar"}]}),e(N,{sx:{p:3},children:a.data&&r.data&&e(G,{onSubmit:t,values:{name:a.data.name??"",description:a.data.description??"",original_price:a.data.original_price,discount_price:a.data.discount_price??null,image:a.data.image??"",category_id:a.data.category_id},categories:r.data})})]})]})};export{O as ProductsEditPage,O as default};

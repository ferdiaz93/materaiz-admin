import{f as v,g as x,j as o,a as e,aj as q,c as E,ak as w,I as M,q as u,al as G,k as T,y as d,C as L,E as S,F as k,i as O,e as j,G as R,H as V,W as Q,A as W,J as $,B as H}from"./index-b7d380d3.js";import{u as U,a as z,b as J,c as _,d as K}from"./categoryRepository-d9c3434c.js";import{C as X,a as Y}from"./CustomBreadcrumbs-a2ae44ce.js";import{u as h,T as F,C as p,a as f,b as A,c as Z}from"./styles-d2076309.js";import{u as ee,T as ae,a as te,b as re}from"./useTableQuery-b2c92c06.js";import{T as y}from"./TemplateTextField-37be45ad.js";import{o as P}from"./yup-f2b37846.js";import"./Close-4b18e9b3.js";import"./InputAdornment-df11fb81.js";import"./KeyboardArrowRight-8229cc2c.js";const oe=v().shape({name:x().required("Nombre es requerido")}),ne={name:""};function se({values:t,onSubmit:a,isLoading:n}){const s=h({resolver:P(oe),defaultValues:ne,values:t,mode:"onChange"});return o(F,{hf:s,onSubmit:a,children:[e(p,{name:"name",render:r=>e(y,{...r,label:"Name"})}),e(f,{children:e(A,{children:"Guardar"})})]})}const B=({open:t,onClose:a,title:n,children:s,isLoading:r})=>e(q,{open:t,onClose:a,fullWidth:!0,children:o(E,{sx:{pointerEvents:r?"none":"auto",opacity:r?.5:1},children:[o(w,{sx:{m:0,p:2},children:[n,e(M,{onClick:a,sx:{position:"absolute",right:8,top:8},children:e(u,{icon:"ic:baseline-close",width:24,color:"grey.500"})})]}),e(G,{sx:{pb:2},children:s})]})}),ie=({open:t,onClose:a,title:n,categoryId:s})=>{const{enqueueSnackbar:r}=T(),{mutateAsync:i}=U(),{data:l}=z(s);return e(B,{open:t,onClose:a,title:n,children:e(se,{onSubmit:async g=>{await i({...g,id:s}),r({message:"Categoría actualizada!"}),a()},values:l})})},le=({data:t,isLoading:a,onDelete:n})=>{const s=h({defaultValues:{name:""}}),[r,i]=d.useState(null),[l,c]=d.useState(null),[g,b]=d.useState(!1),m=d.useRef(),D=()=>{b(!1),c(null)},N=ee([{field:"name",headerName:"Category",type:"string"},{field:"action",headerName:"Actions",type:"actions",renderCell:C=>e(k,{children:e(M,{onClick:I=>{m.current=Number(C.id),i(I.currentTarget)},children:e(u,{icon:"eva:more-vertical-fill"})})})}]);return o(E,{sx:{height:600},children:[e(ae,{filter:{hf:s,render:o(Z,{children:[e(p,{name:"name",render:C=>e(y,{...C,label:"Categoría",placeholder:"Buscar por nombre"})}),o(f,{children:[e(te,{}),e(re,{})]})]})},disableRowSelectionOnClick:!0,rows:t,columns:N}),o(L,{open:r,onClose:()=>{i(null),m.current=void 0},arrow:"right-top",children:[o(S,{onClick:()=>{i(null),n(m.current)},sx:{color:"error.main"},children:[e(u,{icon:"eva:trash-2-outline"}),"Eliminar"]}),o(S,{onClick:()=>{b(!0),c(m.current)},children:[e(u,{icon:"eva:edit-fill"}),"Editar"]})]}),l&&e(ie,{open:g,onClose:D,title:"Editar Categoría",categoryId:l})]})},ce=v().shape({name:x().required("El nombre de la categoría es requerido")}),de={name:""};function ue({onSubmit:t}){const a=h({resolver:P(ce),defaultValues:de,mode:"onChange"});return o(F,{hf:a,onSubmit:t,children:[e(p,{name:"name",control:a.control,render:n=>e(y,{...n,label:"Nombre",placeholder:"Categoría"})}),e(f,{children:e(A,{children:"Crear"})})]})}const me=({open:t,onClose:a,title:n})=>{const{enqueueSnackbar:s}=T(),r=J(),i=O();return e(B,{open:t,onClose:a,title:n,children:e(ue,{onSubmit:async c=>{await r.mutateAsync(c),s({message:"Categoría creda!"}),i(j.dashboard.categories.list)}})})};function Ee(){const{themeStretch:t}=R(),a=V(),n=_(),[s,r]=d.useState(!1),{data:i=[]}=K();return o(k,{children:[e(Q,{children:o("title",{children:[" Panel Administrativo | ",W," "]})}),o($,{maxWidth:t?!1:"lg",children:[e(X,{heading:"Listado - Categorías",links:[{name:"Listado"}],action:e(H,{onClick:()=>r(!0),variant:"contained",startIcon:e(u,{icon:"eva:plus-fill"}),children:"Nueva Categoría"})}),e(Y,{sx:{height:600},children:e(le,{data:i,isLoading:!1,onDelete:l=>a({action:()=>n.mutateAsync(l)})})}),e(me,{open:s,onClose:()=>r(!1),title:"Crear Categoría"})]})]})}export{Ee as CategoriesListPage,Ee as default};

import{f as b,g as d,am as m,t as h,j as s,a as e,k as f,G as y,i as C,F as P,W as _,A as T,J as q,e as p}from"./index-b7d380d3.js";import{b as S}from"./productRepository-6951dba9.js";import{C as A,a as F}from"./CustomBreadcrumbs-a2ae44ce.js";import{o as E}from"./yup-f2b37846.js";import{u as v,T as x,C as c,a as L,b as N}from"./styles-d2076309.js";import{T as g}from"./TemplateNumberField-2f0989b0.js";import{T as k}from"./TemplateSelectField-f4276b4b.js";import{T as u}from"./TemplateTextField-37be45ad.js";import{d as D}from"./categoryRepository-d9c3434c.js";const $=b().shape({name:d().required("El nombre es requerido"),description:d().required("La descripción es requerida"),original_price:m().typeError("El precio original debe ser un número").positive("El precio original debe ser mayor a 0").required("El precio original es requerido"),discount_price:m().transform((i,a)=>a===""||a===null?null:i).nullable().optional().positive("Debe ser mayor a 0").max(h("original_price"),"No puede ser mayor al precio original"),image:d().required("La imagen es requerida"),category_id:m().typeError("La categoría es requerida").positive("Debe seleccionar una categoría").required("La categoría es requerida").moreThan(0,"Debe seleccionar una categoría válida")}),j={name:"",description:"",original_price:0,discount_price:null,image:"",category_id:0};function B({onSubmit:i}){const a=v({resolver:E($),defaultValues:j,mode:"onBlur"}),{data:l}=D();return s(x,{hf:a,onSubmit:i,children:[e(c,{name:"name",control:a.control,render:r=>e(u,{...r,label:"Nombre"})}),e(c,{name:"description",control:a.control,render:r=>e(u,{...r,label:"Descripción"})}),e(c,{name:"original_price",control:a.control,render:({field:r,fieldState:t,formState:o})=>e(g,{field:r,fieldState:t,formState:o,label:"Precio original"})}),e(c,{name:"discount_price",control:a.control,render:({field:r,fieldState:t,formState:o})=>e(g,{field:r,fieldState:t,formState:o,label:"Precio con descuento"})}),e(c,{name:"category_id",control:a.control,render:({field:r,fieldState:t,formState:o})=>e(k,{field:r,fieldState:t,formState:o,label:"Categoría",placeholder:"Seleccionar categoría",options:(l??[]).map(n=>({value:n.id,label:n.name}))})}),e(c,{name:"image",control:a.control,render:r=>e(u,{...r,label:"Imagen (URL)"})}),e(L,{children:e(N,{children:"Crear"})})]})}const U=()=>{const{enqueueSnackbar:i}=f(),a=S(),{themeStretch:l}=y(),r=C(),t=async o=>{try{const n={...o,category_id:o.category_id,images:[{image_url:o.image}]};await a.mutateAsync(n),i({message:"Producto agregado!"}),r(p.dashboard.products.list)}catch(n){console.error("Error al crear producto:",n),i({message:"Error al crear producto",variant:"error"})}};return s(P,{children:[e(_,{children:s("title",{children:[" Panel Administrativo | ",T]})}),s(q,{maxWidth:l?!1:"lg",children:[e(A,{heading:"Alta - Productos",links:[{name:"Listado",href:p.dashboard.products.list},{name:"Alta"}]}),e(F,{sx:{p:3},children:e(B,{onSubmit:t})})]})]})};export{U as ProductsCreatePage,U as default};
